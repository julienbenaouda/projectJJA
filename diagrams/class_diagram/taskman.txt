@startuml

title TASKMAN\n

  package taskman {
    class Initiator {
        {static} + void main(String[] args)
        {static} + void initialize()        
    }
  }

  package taskman {
    class Clock {
        - time : LocalDateTime

        + LocalDateTime getTime()
        + void updateSystemTime(LocalDateTime newTime)
        + accept(Visitor v)
    }
  }

  package taskman {
    class TimeParser {
        {static} - DATE_TIME_FORMATTER : DateTimeFormatter

        {static} + String convertLocalDateTimeToString(LocalDateTime time)
        {static} + LocalDateTime convertStringToLocalDateTime(String time)       
    }
  }

  package taskman {
    interface call Entity {
        + void accept(Visitor v)
    }
  }


  package taskman {
    interface class Visitor {
        + void visitProject(Project p)
        + void visitTask(Task t)
        + void visitTimeSpan(TimeSpan t)
        + void visitClock(Clock c)
        + void visitUser(User u)
    }
  }
  

  package taskman {
    class Controller {
        + Controller()
        + Controller(String initialTime, String UserType)
        + Controller(String initialTime)
        - Controller(HashMap<String, Project> projects, Clock clock)
        + List<String> getProjectNames()
        + boolean projectExists(String projectName)
        - Project getProject(String projectName)
        - void addProject(String name, Project project)
        + HashMap<String, String> getProjectCreationForm()
        + void addProject(HashMap<String, String> form)
        + HashMap<String, String> getProjectDetails(String projectName)
        + list<Integer> getTasksOfProject(String projectName)
        + HashMap<String, String> getTaskDetails(String projectName, Integer taskID)
        + ArrayList<HashMap<String, String>> getAvailableTaskDetails(String projectName)
        + HashMap<String, String> getTaskCreationForm()
        + void addTask(String projectName, HashMap<String, String> form)
        + Integer getLastTaskID()
        + void addAlternativeToTask(String projectName, Integer taskID, Integer alternativeTaskID)
        + void addDependencyToTask(String projectName, Integer taskID, Integer alternativeTaskID)
        + HashMap<String, String> getUpdateTaskStatusForm()
        + void updateTaskStatus(String projectName, Integer taskID, HashMap<String, String> form)
        + String getDelay(String projectName, Integer taskID)
        + String getSystemTime()
        + void updateSystemTime(String timestamp)
        + String getUserType()
        + void setUserType(String userType)
        + void exportToXML(String path)
        {static} + void importFromXML(String path)
    }
  }


  

  package taskman {
    class Project {
        - name : String
        - description : String
        - creationTime : LocalDateTime
        - dueTime : LocalDateTime
        - taskList : ArrayList<Task>

        + Project(String name, String description, LocalDateTime startTime, LocalDateTime dueTime, User user)
        + createTask(String description, long estimatedDuration, double acceptableDeviation, User user)
        + String getName()
        - void setName(String name)
        + String getDescription()
        - void setDescription(String description)
        + LocalDateTime getCreationTime()
        - void setCreationTime(LocalDateTime creationTime)
        + LocalDateTime getDueTime()
        - void setDueTime(LocalDateTime dueTime)
        + List<Task> getTasks()
        + Task getTask(int index)
        - void addTaskToList(Task t)
        + void removeTask(Task task)
        + boolean isFinished()
        + void accept(Visitor v)
    }
  }


  package taskman {
    class ProjectOrganizer {
        - projects : Collection<Project>

        + ProjectOrganizer()
        + Project getProject(String name)
        + createProject(String name, String description, LocalDateTime creationTime, LocalDateTime dueTime, User user
        + Collection<String> getProjectNames()
        + boolean projectExists())
    }
  }
  

  package taskman {
    enum TaskStatus {
        INACTIVE
        FINISHED
        FAILED

        {static} + TaskStatus fromString(String s)
        + String toString()
        + boolean isFinal()
    }
  }
  

  package taskman {
    class Task {
        - description : String
        - estimatedDuration : long
        - acceptableDeviation : double
        - dependencies : ArrayList<Task>
        - TimeSpan timesSpan
        - TaskStatus status

        + Task(String description, long estimatedDuration, double acceptableDeviation)
        - Task(String description, long estimatedDuration, double acceptableDeviation, TimeSpan timeSpan, TaskStatus status)
        + String getDescription()
        - void setDescription(String description)
        + long getEstimatedDuration()
        - void setEstimatedDuration(long duration)
        + double getAcceptableDeviation()
        - void setAcceptableDeviation(double acceptableDeviation)
        + timeSpan getTimeSpan()
        - void setTimeSpan(TimeSpan timeSpan)
        + getStatus()
        - setStatus(TaskStatus status)
        + void updateStatus(LocalDateTime startTime, LocalDateTime endTime, TaskStatus status)
        + boolean isAvailable()
        + isFinished()
        + long getDelay()
        + Task getAlternative()
        + void setAlternative(Task task)
        + ArrayList<Task> getDependencies()
        - void setDependencies(ArayList<Task> tasks)
        + void addDependency(Task task)
        + void removeDependency(Task task)
        {static} - boolean containsLoop(Task root, Task searchedTask)
        + void accept(Visitor v)
    }
  }


  package taskman {
    class TimeSpan {
        - startTime: LocalDateTime
        - endTime: LocalDateTime

        + TimeSpan(LocalDateTime startTime, LocalDateTime endtime)
        + LocalDateTime getStartTime()
        - void setStartTime(LocalDateTime startTime)
        + LocalDateTime getEndTime()
        - void setEndTime(LocalDateTime endTime)
        + boolean canHaveAsEndTime(LocalDateTime endtime)
        + accept(Visitor v)
    }
  }  

  package taskman {
     class ResourceType {
     }
  }

  package taskman {
     class UserManager {
        - users: HashMap<String, User>
        - currentUser: User

        + UserManager()
        - Map<String, User> getUsers()
        + User getCurrentUser()
        + void setCurrentUser(User user)
        + boolean hasCurrentUser()
        + void createUser(String name, String password, String type)
        - void createDeveloper(String name, String password)
        - void createProjectManager(String name, String password)
        + void login(String name, String password)
        + void logout()
     }
  }

  package taskman {
     abstract class User {
        - name: String
        - password: String

        + User(String name, String password)
        + String getName()
        - void setName(String name)
        + String getPassword()
        - void setPassword(String password)
        + accept(Visitor v)
     }
  }

  package taskman {
     class ProjectManager {
         + ProjectManager(String name, String password)
     }
  }

  package taskman {
     class Developer {
        + Developer(String name, String password)
     }
  }

  package taskman {
    class UserInterface {
        # UI()
        + void welcomeDialog()
        + void showUserChoiceDialog()
        + void showMainMenu()
        + void showSystemTime()
        + void listProjects()
        + void importFile()
        + void exportFile()
        + void showProjectMenu()
        + void showProjectMenu(String projectName)
        + void addAlternative(String projectName)
        + void addDependency(String projectName)
        + void showProjectDetails(String projectName)
        + void showTaskDetails(String projectName)
        + void createTask(String projectName)
        + void showAvailableTasks(String prjectName)
        - void fillInTaskUpdateForm()
        + void updateTaskStatus(String projectName)
        + void createProject()
        + void advanceSystemTime()
        + void print(String text)
        - int inputInt()
        # String inputString()
        + Controller getController()
        {static} + void main()
    }
  }
  

  package taskman {
    class ImportExportException {
        + ImportExportException(String message)
    }
  }

  package taskman {
    class OperationNetPermittedException {
        + OperationNotPermittedException(String message)
    }
  }  
   
  package taskman {
    class XmlObject {
        - doc : Document
        - element : Element

        + XmlObject()
        - XmlObject(Document doc, Element e)
        + void exportTo(String path)
        {static} + XmlObject importFrom(String path)
        + List<XmlObject> getXmlObjects(String name)
        + XmlObject getXmlObject(String name)
        + XmlObject createXmlLObject(String name)
        + String getAttribute(String name)
        + void addAttribute(String name, String value)        
        + List<String> getTexts(String name)
        + String getText(String name)
        + void addText(String element, String value)
    }
  }
  

  Controller *-- Clock 
  Controller *-- Project
  Controller o-- Task
  Controller o-- XmlObject
  Controller o-- User
  Project *-- Task: task
  Task *-- Task : alternative
  Task *-- Task: dependencies
  Task *-- TimeSpan: timespans
  TimeSpan *-- TaskStatus : status
  UI *-- Controller : controller
  User *-- UserType: usertype
  XmlObject o-- Project
  XmlObject o-- Task
  XmlObject o-- User
  XmlObject o-- Clock
  XmlObject o-- XmlException
  UI o-- XmlException
  controller o-- UserManager
  UserManager o-- User
  UserManager o-- Developer
  UserManager o-- ProjectManager
  Developer <|-- User
  ProjectManager <|-- User
  Task o-- User
  Project o-- User
  Controller o-- User


@enduml
